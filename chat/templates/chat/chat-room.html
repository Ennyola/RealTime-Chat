{% extends "base.html" %}
{% load static %}

{% block friends %}
    {% include 'chat/snippets/_friends.html' %}
{% endblock  %}

{% block stylesheet %}
    <link rel="stylesheet" href="{% static 'chat/css/chatroom.css' %}">
{% endblock  %}

{% block header_settings %}
    <header>   
        {% include '_header_settings.html' %}
    </header>
{% endblock  %}

{% block chat-room %}
    {{room_name|json_script:"room-name"}}
    <div class="header-settings">
        <div class="single-friend">
            <img src="{{display_picture}}" id="friend-display-picture" class="display-picture" alt="friend-picture">
            <div class="text">
                <h6> {{room_name}}</h6>
            </div>
            <span class="settings-icon">
                <i id="voice-call-icon" class="fas fa-phone"></i>
                <i id="video-call-icon" class="fas fa-video"></i>
            </span>
        </div>
    </div>
    <div class="messages">
        {% for message_group in message_groups %}
            <div class="message-date">
                <span>{{message_group.date}}</span>
            </div>
            {% for message in message_group.messages  %}
                {% if message.sender == request.user %}
                    <div class="outgoing-message">
                        <div class="chat-bubble">
                            <div class="msg">{{message.content}}</div>
                            <span class ="msg-metadata">
                                <span class = "msg-time">{{message.time.time}}</span> 
                                <span class="chat-status">
                                    <i class="fas fa-check"></i>
                                </span>
                            </span>
                        </div>
                    </div>
                {% else %}
                    <div class="incoming-message">
                        <div class="chat-bubble">
                            <div class="msg">
                                {{message.content}}
                            </div>
                            <span class ="msg-metadata">
                                <span class = "msg-time">{{message.time.time}}</span> 
                            </span>
                        </div>
                    </div>    
                {% endif %}
            {% endfor %}    
        {% endfor %}   
        
    </div> 
    <div class="message-box">
        <div class="input-wrapper">
            <div class="emoji-attachment">
                <span class="icons" ><i class="far fa-smile"></i></span> 
                <span class="icons" ><i class="fas fa-paperclip"></i></i></span>
            </div>  
            <div class="text-input">
                <input class="form-control" id = "input-message" type="text" placeholder="type message" name="" id="">
                <span class="icons" ><i class="fas fa-paper-plane" id ="send-button"></i></span>
            </div>
        </div>
    </div>
{% endblock  %}

{% block script %}
      <script type="module" src="{% static 'chat/js/chatroom.js' %}"></script>
      <script type="module" src="{% static 'chat/js/videoCall.js' %}"></script>
{% endblock  %} 